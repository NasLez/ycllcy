{"ast":null,"code":"import axios from \"axios\";\nexport default {\n  name: \"ProjectDetail\",\n  data() {\n    return {\n      showChannel: \"\",\n      editDialogVisible: false,\n      editStatus: \"\",\n      userinfo: {\n        \"id\": \"\",\n        \"username\": \"\",\n        \"phone\": \"\",\n        \"email\": \"\",\n        \"school\": \"\",\n        \"password\": \"\",\n        \"isAdmin\": \"\",\n        \"code\": \"\",\n        \"name\": \"\"\n      },\n      project: {\n        id: '',\n        name: '',\n        uploaderEmail: '',\n        maintainer: '',\n        channelId: '',\n        description: '',\n        company: '',\n        money: '',\n        setTime: '',\n        status: '',\n        startYear: ''\n      }\n    };\n  },\n  created() {\n    let that = this;\n    this.project.id = this.$route.query.id;\n    // this.$data.project.Id = 5\n    console.log(this.$data.project.id);\n    this.userinfo.email = this.$route.query.email;\n    // this.$data.userinfo.email =\"1730808730@qq.com\"\n    console.log(this.$data.userinfo.email);\n    getUSerAndProject(this.$data.userinfo.email, this.$data.project.id);\n    function getUSerAndProject(email, id) {\n      axios.get(`mu/getUsernames/email=${email}`, {\n        email: email\n      }).then(res => {\n        console.log(res.data);\n        console.log(\"打印用户信息\");\n        that.$data.userinfo.id = res.data.id;\n        that.$data.userinfo.username = res.data.username;\n        that.$data.userinfo.isAdmin = res.data.isAdmin;\n        that.$data.userinfo.name = res.data.name;\n        that.$data.userinfo.phone = res.data.phone;\n        that.$data.userinfo.email = res.data.email;\n        that.$data.userinfo.school = res.data.school;\n        that.$data.userinfo.password = res.data.password;\n        that.$data.userinfo.code = res.data.code;\n        that.$data.project.uploaderEmail = res.data.email;\n      });\n      axios.get(`mu/project/queryById?id=${id}`, {\n        id: id\n      }).then(res => {\n        console.log(res.data);\n        console.log(\"项目信息\");\n        that.$data.project.id = res.data.id;\n        that.$data.project.channelId = res.data.channelId;\n        that.$data.project.name = res.data.name;\n        that.$data.project.maintainer = res.data.maintainer;\n        that.$data.project.description = res.data.description;\n        that.$data.project.company = res.data.company;\n        that.$data.project.money = res.data.money;\n        that.$data.project.setTime = res.data.setTime;\n        that.$data.project.status = res.data.status;\n        that.$data.project.startYear = res.data.startYear;\n        axios.get(`mu/getChannelById?id=${that.$data.project.channelId}`, {\n          id: that.$data.project.channelId\n        }).then(res => {\n          console.log(res.data);\n          console.log(\"打印通道信息\");\n          that.$data.showChannel = res.data.name;\n        });\n      });\n    }\n  },\n  methods: {\n    showEditDialog() {\n      this.$data.editDialogVisible = true;\n    },\n    editDialogClosed() {\n      this.$refs.editFormRef.resetFields();\n    },\n    changeStatus() {\n      let that = this;\n      axios.post(`mu/project/changeStatus?id=${that.$data.project.id}&status=${that.$data.editStatus}`, {\n        id: that.$data.project.id,\n        status: that.$data.editStatus\n      }).then(res => {\n        console.log(\"修改状态成功\");\n        console.log(res.data);\n      });\n      this.editDialogVisible = false;\n      this.project.status = this.editStatus;\n    },\n    downloadProfile() {\n      let that = this;\n      window.open(`mu/project/download/${that.$data.project.id}/zip`, \"_blank\");\n    },\n    downloadPic() {\n      let that = this;\n      window.open(`mu/project/download/${that.$data.project.id}/fig`, \"_blank\");\n    }\n  }\n};","map":{"version":3,"mappings":"AA2CA;AAEA;EACAA;EAEAC;IACA;MACAC;MACAC;MACAC;MACAC;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;MACA;MACAC;QACAC;QACAP;QACAQ;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;MACA;IACA;EACA;EACAC;IACA;IACA;IACA;IACAC;IACA;IACA;IACAA;IACAC;IAEA;MACAC;QACAC;MACA;QACAH;QACAA;QACAI;QACAA;QACAA;QACAA;QACAA;QACAA;QACAA;QACAA;QACAA;QACAA;MACA;MACAF;QACAb;MACA;QACAW;QACAA;QACAI;QACAA;QACAA;QACAA;QACAA;QACAA;QACAA;QACAA;QACAA;QACAA;QACAF;UACAb;QACA;UACAW;UACAA;UACAI;QACA;MACA;IACA;EACA;EACAC;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;MACAN;QACAb;QACAQ;MACA;QACAG;QACAA;MACA;MACA;MACA;IACA;IACAS;MACA;MACAC;IACA;IACAC;MACA;MACAD;IACA;EACA;AAEA","names":["name","data","showChannel","editDialogVisible","editStatus","userinfo","project","id","uploaderEmail","maintainer","channelId","description","company","money","setTime","status","startYear","created","console","getUSerAndProject","axios","email","that","methods","showEditDialog","editDialogClosed","changeStatus","downloadProfile","window","downloadPic"],"sourceRoot":"src/view","sources":["ProjectDetail.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <el-descriptions title=\"项目信息\">\r\n      <el-descriptions-item label=\"项目名称\">{{project.name}}</el-descriptions-item>\r\n      <el-descriptions-item label=\"负责人\">{{ project.maintainer }}</el-descriptions-item>\r\n      <el-descriptions-item label=\"项目简介\">{{ project.description }}</el-descriptions-item>\r\n      <el-descriptions-item label=\"项目类别\">\r\n        <el-tag size=\"small\">{{ showChannel }}</el-tag>\r\n      </el-descriptions-item>\r\n      <el-descriptions-item label=\"负责单位\">{{ project.company }}</el-descriptions-item>\r\n      <el-descriptions-item label=\"开始年份\">{{project.startYear}}</el-descriptions-item>\r\n      <el-descriptions-item label=\"金额\">{{project.money}}</el-descriptions-item>\r\n      <el-descriptions-item label=\"上传时间\">{{project.setTime}}</el-descriptions-item>\r\n      <el-descriptions-item label=\"项目状态\">\r\n        <el-tag size=\"small\">{{ project.status}}</el-tag>\r\n      </el-descriptions-item>\r\n      <el-descriptions-item label=\"下载\">\r\n        <el-button @click=\"downloadProfile\">点击下载项目文件</el-button>\r\n        <el-button @click=\"downloadPic\">点击下载图片凭证</el-button>\r\n      </el-descriptions-item>\r\n    </el-descriptions>\r\n\r\n    <el-button @click=\"showEditDialog\" v-if=\"userinfo.isAdmin == 0\">审核</el-button>\r\n\r\n    <el-card class=\"box-card\" style=\"position: absolute;left: 400px\" v-if=\"editDialogVisible\">\r\n      <el-dialog\r\n          title=\"请问您的审核结果是？\"\r\n          :visible.sync=\"editDialogVisible\"\r\n          width=\"50%\" @close=\"editDialogClosed\">\r\n        <el-radio v-model=\"editStatus\" label=\"Accept\">审核通过</el-radio>\r\n        <el-radio v-model=\"editStatus\" label=\"Reject\">审核驳回</el-radio>\r\n        <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"editDialogVisible = false; editStatus ='Waiting' \">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"changeStatus\">确 定</el-button>\r\n      </span>\r\n      </el-dialog>\r\n    </el-card>\r\n  </div>\r\n\r\n  <!--  <el-button @click=\"updateProject\" v-else>修改论文</el-button>-->\r\n</template>\r\n\r\n<script>\r\nimport axios from \"axios\";\r\n\r\nexport default {\r\n  name: \"ProjectDetail\",\r\n\r\n  data(){\r\n    return{\r\n      showChannel:\"\",\r\n      editDialogVisible:false,\r\n      editStatus:\"\",\r\n      userinfo: {\r\n        \"id\":\"\",\r\n        \"username\": \"\",\r\n        \"phone\": \"\",\r\n        \"email\": \"\",\r\n        \"school\": \"\",\r\n        \"password\": \"\",\r\n        \"isAdmin\": \"\",\r\n        \"code\": \"\",\r\n        \"name\": \"\"\r\n      },\r\n      project: {\r\n        id:'',\r\n        name: '',\r\n        uploaderEmail: '',\r\n        maintainer: '',\r\n        channelId: '',\r\n        description: '',\r\n        company: '',\r\n        money: '',\r\n        setTime: '',\r\n        status: '',\r\n        startYear: ''\r\n      },\r\n    }\r\n  },\r\n  created() {\r\n    let that = this;\r\n    this.project.id = this.$route.query.id\r\n    // this.$data.project.Id = 5\r\n    console.log(this.$data.project.id)\r\n    this.userinfo.email = this.$route.query.email\r\n    // this.$data.userinfo.email =\"1730808730@qq.com\"\r\n    console.log(this.$data.userinfo.email)\r\n    getUSerAndProject(this.$data.userinfo.email, this.$data.project.id);\r\n\r\n    function getUSerAndProject(email, id) {\r\n      axios.get(`mu/getUsernames/email=${email}`, {\r\n        email: email,\r\n      }).then(res => {\r\n        console.log(res.data);\r\n        console.log(\"打印用户信息\");\r\n        that.$data.userinfo.id = res.data.id;\r\n        that.$data.userinfo.username = res.data.username;\r\n        that.$data.userinfo.isAdmin = res.data.isAdmin;\r\n        that.$data.userinfo.name = res.data.name;\r\n        that.$data.userinfo.phone = res.data.phone;\r\n        that.$data.userinfo.email = res.data.email;\r\n        that.$data.userinfo.school = res.data.school;\r\n        that.$data.userinfo.password = res.data.password;\r\n        that.$data.userinfo.code = res.data.code;\r\n        that.$data.project.uploaderEmail = res.data.email;\r\n      });\r\n      axios.get(`mu/project/queryById?id=${id}`, {\r\n        id: id\r\n      }).then(res => {\r\n        console.log(res.data);\r\n        console.log(\"项目信息\")\r\n        that.$data.project.id = res.data.id;\r\n        that.$data.project.channelId=res.data.channelId;\r\n        that.$data.project.name = res.data.name;\r\n        that.$data.project.maintainer = res.data.maintainer;\r\n        that.$data.project.description = res.data.description;\r\n        that.$data.project.company = res.data.company;\r\n        that.$data.project.money = res.data.money;\r\n        that.$data.project.setTime = res.data.setTime;\r\n        that.$data.project.status = res.data.status;\r\n        that.$data.project.startYear = res.data.startYear;\r\n        axios.get(`mu/getChannelById?id=${that.$data.project.channelId}`, {\r\n          id: that.$data.project.channelId\r\n        }).then(res => {\r\n          console.log(res.data);\r\n          console.log(\"打印通道信息\")\r\n          that.$data.showChannel = res.data.name;\r\n        })\r\n      });\r\n    }\r\n  },\r\n  methods: {\r\n    showEditDialog(){\r\n      this.$data.editDialogVisible = true;\r\n    },\r\n    editDialogClosed(){\r\n      this.$refs.editFormRef.resetFields()\r\n    },\r\n    changeStatus(){\r\n      let that = this;\r\n      axios.post(`mu/project/changeStatus?id=${that.$data.project.id}&status=${that.$data.editStatus}`, {\r\n        id: that.$data.project.id,\r\n        status: that.$data.editStatus\r\n      }).then(res => {\r\n        console.log(\"修改状态成功\")\r\n        console.log(res.data)\r\n      });\r\n      this.editDialogVisible = false\r\n      this.project.status = this.editStatus\r\n    },\r\n    downloadProfile(){\r\n      let that = this;\r\n      window.open(`mu/project/download/${that.$data.project.id}/zip`,\"_blank\")\r\n    },\r\n    downloadPic(){\r\n      let that = this;\r\n      window.open(`mu/project/download/${that.$data.project.id}/fig`,\"_blank\")\r\n    }\r\n  }\r\n\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}